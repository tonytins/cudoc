@page "/gallery"
@inject HttpClient http
<DynMeta Name="Gallery" />
@if (_isReady)
{
    <div class="row">
        @foreach (var submission in _submissions)
        {
            <div class="column">
                <GalleryThumb Source="@submission" />
            </div>
        }
    </div>
}
else
{
    <LoadingBar />
}

@code {
    List<string> _submissions = new List<string>();
    bool _isReady = false;

    protected override async Task OnParametersSetAsync()
    {

        // Obtain the CSV file containing the image path and ID
        var db = await http.GetStreamAsync(GlobalConsts.GALLERY_CSV);
        var images = SiteHelper.ImagesFromPath(db, "gallery");
        var buddy = "be_my_buddy.png";

        // Temporarily remove Be My Buddy, due to size issues
        if (images.Contains(buddy))
            images.Remove(buddy);

        _submissions = images;

        // Set the flag to indicate that the component is ready
        _isReady = true;
    }
}

